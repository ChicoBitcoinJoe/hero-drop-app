{"version":3,"sources":["services/Magic.js","hooks/useObject.js","hooks/useList.js","services/Scene.js","components/AssetEditor.js","components/gameboard/Asset.js","components/gameboard/Assets.js","hooks/useKeyPress.js","components/gameboard/Background.js","components/gameboard/Grid.js","components/gameboard/GameBoard.js","defaultScene.js","App.js","hooks/useDocumentTitle.js","serviceWorker.js","index.js"],"names":["Box","require","Magic","RPCError","RPCErrorCode","magic","network","useMagic","React","useState","isLoggedIn","setLoggedIn","isLoggingIn","email","setEmail","address","box","space","login","a","auth","loginWithMagicLink","showUI","user","getMetadata","metadata","publicAddress","spaces","provider","rpcProvider","create","syncDone","storage","Error","console","error","code","MagicLinkFailedVerification","MagicLinkExpired","MagicLinkRateLimited","UserAlreadyLoggedIn","logout","data","set","useObject","initialState","state","setState","newState","prevState","useList","initialList","list","setList","get","index","changes","newList","updateItem","item","setItem","push","pop","length","slice","concat","useSceneManager","Scene","name","setName","assets","background","updateBackground","setBackground","grid","updateGrid","setGrid","useEffect","interval","src","width","height","ref","current","offsetHeight","offsetWidth","hexSize","clearInterval","hidden","setInterval","makeStyles","theme","form","display","flexWrap","AvatarAsset","asset","style","zIndex","Avatar","border","backgroundColor","text","whiteSpace","textAlign","color","textColor","margin","padding","overflow","textOverflow","borderRadius","fontWeight","TextAsset","fontSize","ObjectAsset","rotation","alt","onLoad","WebkitTransform","MozTransform","msTransform","OTransform","transform","Asset","type","Assets","ContextMenu","onChange","locked","ctrlDown","keyCode","keyDown","setKeyDown","onKeyDown","key","onKeyUp","document","addEventListener","removeEventListener","useKeyPress","handleGrab","id","event","prop","x","y","target","function","handleDrag","handleDrop","map","draggable","disabled","position","onStart","onDrag","onStop","className","cursor","userSelect","pointerEvents","Background","top","left","Grid","container","settings","onContextMenuOpen","onClick","xOffset","yOffset","onContextMenu","viewBox","size","spacing","flat","origin","GridGenerator","rectangle","hex","i","q","r","s","blocked","GameBoard","sync","player","allowRightClick","ping","props","offsetX","offsetY","ignoreElements","hideScrollbars","nativeEvent","log","e","onShown","onAssetRightClick","onEditAsset","label","onRemoveAsset","change","defaultScene","customMuiTheme","createMuiTheme","palette","Server","joinThread","ghost","thread","unsyncedData","post","onUpdate","fn","LoginButton","handleLogin","createRef","anchorEl","open","setOpen","Button","variant","Popper","placement","Paper","marginTop","maxWidth","elevation","noValidate","autoComplete","onSubmit","preventDefault","TextField","inputProps","fullWidth","placeholder","value","App","title","scene","setPlayer","loggedIn","loggingIn","setLoggingIn","server","setServer","handleSync","b","author","serverObj","_3id","DID","message","playerObj","CssBaseline","right","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.96b4f185.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst Box = require('3box');\r\nconst ethers = require('ethers');\r\nconst { Magic, RPCError, RPCErrorCode } = require('magic-sdk');\r\nconst magic = new Magic('pk_test_F879423DC899077C', {\r\n  network: \"ropsten\" // Supports \"mainnet\", \"rinkeby\", \"ropsten\", \"kovan\"\r\n});\r\n\r\nconst useMagic = () => {\r\n  const [isLoggedIn, setLoggedIn] = React.useState(false);\r\n  const [isLoggingIn, setIsLoggingIn] = React.useState(false);\r\n  const [email, setEmail] = React.useState('');\r\n  const [address, setAddress] = React.useState();\r\n  const [box, setBox] = React.useState();\r\n  const [space, setSpace] = React.useState();\r\n\r\n  const login = async (email) => {\r\n    try {\r\n      await magic.auth.loginWithMagicLink({ email, showUI: true });\r\n      if(await magic.user.isLoggedIn()) {\r\n        const metadata = await magic.user.getMetadata();\r\n        const address = metadata.publicAddress;\r\n        const spaces = ['hero-drop-app'];\r\n        const provider = magic.rpcProvider;\r\n        const box = await Box.create();\r\n        await box.auth(spaces, { address, provider })\r\n        await box.syncDone\r\n        const storage = box.spaces['hero-drop-app']\r\n        //console.log(metadata, box)\r\n        return {\r\n          email,\r\n          metadata,\r\n          address,\r\n          provider,\r\n          box,\r\n          storage\r\n        }\r\n      }\r\n      else {\r\n        throw new Error('failed to log in');\r\n      }\r\n    } catch(err) {\r\n      console.error(err)\r\n      if (err instanceof RPCError) {\r\n        switch(err.code) {\r\n          case RPCErrorCode.MagicLinkFailedVerification:\r\n          case RPCErrorCode.MagicLinkExpired:\r\n          case RPCErrorCode.MagicLinkRateLimited:\r\n          case RPCErrorCode.UserAlreadyLoggedIn:\r\n          default: // Handle errors accordingly :)\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n  const login = async (email) => {\r\n    setEmail(email)\r\n    setIsLoggingIn(true);\r\n    try {\r\n      await magic.auth.loginWithMagicLink({ email, showUI: true });\r\n      if(await magic.user.isLoggedIn()) {\r\n        let metadata = await magic.user.getMetadata();\r\n        const address = metadata.publicAddress;\r\n        const spaces = ['hero-drop-app'];\r\n        const provider = new ethers.providers.Web3Provider(magic.rpcProvider);\r\n        const box = await Box.create();\r\n        await box.auth(spaces, { address, provider })\r\n        await box.syncDone\r\n        console.log(metadata, box)\r\n        setAddress(metadata.publicAddress);\r\n        setBox(box);\r\n        setSpace(box.spaces['hero-drop-app']);\r\n        setLoggedIn(true);\r\n      }\r\n      else {\r\n        throw new Error('failed to log in');\r\n      }\r\n    } catch(err) {\r\n      console.error(err)\r\n      if (err instanceof RPCError) {\r\n        switch(err.code) {\r\n          case RPCErrorCode.MagicLinkFailedVerification:\r\n          case RPCErrorCode.MagicLinkExpired:\r\n          case RPCErrorCode.MagicLinkRateLimited:\r\n          case RPCErrorCode.UserAlreadyLoggedIn:\r\n          default: // Handle errors accordingly :)\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    setIsLoggingIn(false);\r\n  }\r\n  */\r\n\r\n  const logout = async () => {\r\n    await box.logout();\r\n    await magic.user.logout();\r\n    setLoggedIn(false);\r\n  }\r\n    \r\n  return {\r\n    email,\r\n    isLoggingIn,\r\n    isLoggedIn,\r\n    address,\r\n    box,\r\n    data: space,\r\n    login,\r\n    logout,\r\n    set: {\r\n      email: setEmail,\r\n    }\r\n  }\r\n}\r\n\r\nexport default useMagic;\r\n","import React from 'react';\r\n\r\nexport default function useObject(initialState) {\r\n\r\n  const [state, setState] = React.useState(initialState)\r\n\r\n  const updateState = (newState) => {\r\n    setState(prevState => {\r\n      return {\r\n        ...prevState,\r\n        ...newState\r\n      }\r\n    })\r\n  }\r\n\r\n  return [state, updateState, setState];\r\n}","import React from 'react'\r\n\r\nexport default function useList(initialList) {\r\n\r\n  const [list, setList] = React.useState(initialList);\r\n\r\n  const push = (item) => {\r\n    setList([...list, item])\r\n  }\r\n\r\n  const setItem = (index, item) => {\r\n    let newList = list;\r\n    newList[index] = item;\r\n    setList([...newList])\r\n  }\r\n\r\n  const updateItem = (index, changes) => {\r\n    let newList = list;\r\n    newList[index] = {\r\n      ...list[index],\r\n      ...changes\r\n    }\r\n    setList([...newList])\r\n  }\r\n\r\n  const get = (index) => {\r\n    return [\r\n      list[index],\r\n      (changes) => {\r\n        updateItem(index, changes)\r\n      },\r\n      (item) => {\r\n        setItem(index, item)\r\n      }\r\n    ];\r\n  }\r\n\r\n  const pop = (index) => {\r\n    if(!index) index = list.length-1;\r\n    if(index < 0 || index >= list.length) return false;\r\n    const newList = list.slice(0,index).concat(list.slice(index+1, list.length));\r\n    setList(newList);\r\n    return true;\r\n  }\r\n\r\n  return {\r\n    list,\r\n    get,\r\n    push,\r\n    pop,\r\n  }\r\n\r\n}","import React from 'react';\r\n\r\nimport useObject from '../hooks/useObject';\r\nimport useList from '../hooks/useList';\r\n\r\nexport default function useSceneManager(Scene) {\r\n\r\n  const [name, setName] = React.useState(Scene.name)\r\n  const assets = useList(Scene.assets);\r\n  const [background, updateBackground, setBackground] = useObject(Scene.background);\r\n  const [grid, updateGrid, setGrid] = useObject(Scene.grid);\r\n\r\n  React.useEffect(() => {\r\n    //updateBackground({ ref: React.createRef() })\r\n  }, [])\r\n\r\n  /* START HACKS */\r\n\r\n  /* This is a hack to make the grid size update properly */\r\n  let interval = null;\r\n  const hideGrid = () => {\r\n    if(interval) clearInterval(interval)\r\n    \r\n    updateGrid({hidden: true})\r\n    interval = setInterval(() => {\r\n      clearInterval(interval)        \r\n      updateGrid({hidden: false})\r\n    }, 0)\r\n  }\r\n\r\n  /* END HACKS */\r\n\r\n  return [\r\n    {\r\n      name,\r\n      assets,\r\n      background,\r\n      grid\r\n    },\r\n    {\r\n      name: setName,\r\n      background: updateBackground,\r\n      grid: updateGrid,\r\n      src: async (src) => {\r\n        await updateBackground({src, width: 0, height: 0})\r\n        updateBackground({\r\n          height: background.ref.current.offsetHeight,\r\n          width: background.ref.current.offsetWidth\r\n        })\r\n      },\r\n      width: async (width) => {\r\n        await updateBackground({width, height: 0})\r\n        updateBackground({height: background.ref.current.offsetHeight})\r\n      },\r\n      height: async (height) => {\r\n        await updateBackground({height, width: 0})\r\n        updateBackground({width: background.ref.current.offsetWidth})\r\n      },\r\n      hexSize: (hexSize) => {\r\n        hideGrid()\r\n        updateGrid({hexSize: hexSize})\r\n      },\r\n    },\r\n    {\r\n      background: setBackground,\r\n      grid: setGrid\r\n    }\r\n  ]\r\n}","import React from 'react';\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nimport AssetForm from './AssetForm';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  form: {\r\n    display: 'flex',\r\n    flexWrap: 'wrap',\r\n  }\r\n}));\r\n\r\nexport default function AssetEditor({ open, anchorEl, editableAsset, onClose }) {\r\n  \r\n  const classes = useStyles();\r\n  const [asset, editAsset] = editableAsset;  \r\n\r\n  const closeEditor = () => {\r\n    onClose()\r\n  }\r\n\r\n  return <>\r\n    <Grid container direction=\"row\" justify={'space-between'} alignItems={'center'}>\r\n      <Grid item>\r\n        <div style={{ fontWeight: 'bold', fontSize: '18px'}}>Asset Editor</div>\r\n      </Grid>\r\n      <Grid item>\r\n        <IconButton onClick={closeEditor}>\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </Grid>\r\n    </Grid>\r\n    <form className={classes.form} noValidate autoComplete=\"off\">\r\n      <AssetForm asset={asset} editAsset={editAsset} anchorEl={anchorEl} />\r\n    </form>\r\n  </>\r\n}","import React from 'react'\r\n\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\nfunction Asset({ asset }) {\r\n  return <>\r\n    {\r\n      asset.type === 'avatar' ? <AvatarAsset asset={asset} /> :\r\n      asset.type === 'text' ? <TextAsset asset={asset} /> :\r\n      asset.type === 'object' ? <ObjectAsset asset={asset} /> :\r\n      null\r\n    }\r\n  </>\r\n}\r\n\r\nfunction AvatarAsset({ asset }) {\r\n  return <>\r\n    <div style={{ zIndex: '2', width: (asset.width * 96) + 'px', height: (asset.height * 96 + 24) + 'px' }}>\r\n      <Avatar style={{ \r\n          border: '4px solid ' + (asset.backgroundColor ? asset.backgroundColor : 'rgba(255,255,255,1)'), \r\n          width: asset.width + 'in', \r\n          height: asset.height + 'in'\r\n        }}\r\n        ref={asset.ref}\r\n        src={asset.src}\r\n      />\r\n      {\r\n        !asset.text ? null :\r\n        <div style={{ \r\n          whiteSpace: 'nowrap',\r\n          textAlign: 'center',\r\n          backgroundColor: (asset.backgroundColor ? asset.backgroundColor : 'rgba(255,255,255,1)'), \r\n          color: (asset.textColor ? asset.textColor : 'rgba(0,0,0,1)'),\r\n          margin: '4px 0px', \r\n          padding: '0px 8px', \r\n          height: '20px', \r\n          width: asset.width + 'in', \r\n          overflow: 'hidden', \r\n          textOverflow: 'ellipsis', \r\n          borderRadius: '16px',\r\n          fontWeight: 'bold'\r\n        }}>\r\n          {asset.text}\r\n        </div> \r\n      }\r\n    </div>\r\n  </>\r\n}\r\n\r\nfunction TextAsset({ asset }) {\r\n  return <>\r\n    <div style={{ \r\n      fontSize: asset.fontSize + 'px', \r\n      fontWeight: asset.fontWeight, \r\n      color: (asset.textColor ? asset.textColor : 'rgba(0,0,0,1)'),\r\n      width: asset.width + 'px', \r\n      height: asset.height + 'px',\r\n      border: '8px solid ' + (asset.backgroundColor ? asset.backgroundColor : 'rgba(255,255,255,0)'),\r\n      backgroundColor: asset.backgroundColor,\r\n    }}>\r\n      {asset.text}\r\n    </div>\r\n  </>\r\n}\r\n\r\nfunction ObjectAsset({ asset }) {\r\n  let rotation = 'rotate(' + asset.rotation + 'deg)';\r\n  return <>\r\n    <img alt=\"object asset\" \r\n      src={asset.src} \r\n      onLoad={asset.onLoad}\r\n      ref={asset.ref} \r\n      style={{ \r\n        zIndex: '2', \r\n        width: asset.width ? asset.width + 'px' : 'auto', \r\n        height: asset.height ? asset.height + 'px' : 'auto',\r\n        WebkitTransform: rotation,\r\n        MozTransform: rotation,\r\n        msTransform: rotation,\r\n        OTransform: rotation,\r\n        transform: rotation,\r\n      }} \r\n    />\r\n  </>\r\n}\r\n\r\nexport default Asset;\r\n","import React from 'react';\r\n\r\nimport Draggable from 'react-draggable'\r\nimport { Menu, Item, Separator, Submenu, MenuProvider } from 'react-contexify'\r\n\r\nimport Popper from '@material-ui/core/Popper';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nimport AssetEditor from '../AssetEditor';\r\nimport Asset from './Asset';\r\nimport useKeyPress from '../../hooks/useKeyPress';\r\n\r\nconst popperOptions = {\r\n  placement: \"right-start\",\r\n  disablePortal: true,\r\n  modifiers: {\r\n    flip: {\r\n      enabled: true,\r\n    },\r\n    preventOverflow: {\r\n      enabled: true,\r\n      boundariesElement: 'scrollParent',\r\n    },\r\n  }\r\n}\r\n\r\nconst paperStyles = { \r\n  zIndex: '5', \r\n  maxWidth: '272px', \r\n  maxHeight: '320px', \r\n  padding: '12px', \r\n  margin: '24px', \r\n  overflow: 'auto' \r\n};\r\n\r\nexport default function Assets({ assets, ContextMenu, onChange, locked }) {\r\n  \r\n  const ctrlDown = useKeyPress('Control');\r\n  const [anchorEl, setAnchorEl] = React.useState();\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  const handleEditAsset = ({event}, i) => {\r\n    console.log(event, i)\r\n    setAnchorEl(event.srcElement)\r\n    setOpen(true)\r\n    //onEditAsset(i)\r\n  }\r\n\r\n  const handleClose = () => {\r\n    setOpen(false)\r\n  }\r\n  \r\n  const handleGrab = (id, asset) => (event, prop) => {\r\n    let x = prop.x;\r\n    let y = prop.y;\r\n    onChange({\r\n      target: 'asset',\r\n      function: 'handleGrab',\r\n      data: { id, x, y }\r\n    })\r\n  }\r\n\r\n  let interval = null;\r\n  let x = null;\r\n  let y = null;\r\n  const handleDrag = (id, asset) => (event, prop) => {\r\n    x = prop.x;\r\n    y = prop.y;\r\n    if(interval) return;\r\n    interval = setInterval(() => {\r\n      onChange({\r\n        target: 'asset',\r\n        function: 'handleDrag',\r\n        data: { id, x, y }\r\n      })\r\n    }, 250)\r\n  }\r\n\r\n  const handleDrop = (id, asset) => (event, prop) => {\r\n    let x = prop.x;\r\n    let y = prop.y;\r\n    onChange({\r\n      target: 'asset',\r\n      function: 'handleDrop',\r\n      data: { id, x, y }\r\n    })    \r\n    clearInterval(interval)\r\n  }\r\n  \r\n  return <>\r\n    {\r\n      assets.list.map((asset, id) => {\r\n        let draggable = (!asset.locked || ctrlDown) && !locked;\r\n        return <div key={id}>\r\n          <MenuProvider id={'asset_menu' + id}>\r\n            <Draggable disabled={!draggable} \r\n              position={{ x: asset.x, y: asset.y }}\r\n              onStart={handleGrab(id, asset)}\r\n              onDrag={handleDrag(id, asset)}\r\n              onStop={handleDrop(id, asset)}\r\n            >\r\n              <div className=\"game-piece\" \r\n                style={{ \r\n                  cursor: !draggable ? 'default' : 'grab', \r\n                  userSelect: draggable ? 'default' : 'none', \r\n                  pointerEvents: draggable ? 'auto' : 'none',\r\n                }}\r\n              >\r\n                <div style={{ pointerEvents: 'none'}}>\r\n                  <Asset asset={asset} />\r\n                </div>\r\n              </div>\r\n            </Draggable>\r\n          </MenuProvider>\r\n          {ContextMenu(asset, id)}\r\n        </div>\r\n      })\r\n    }\r\n  </>\r\n}\r\n\r\n/*\r\n    <Popper open={open && selectedAsset >= 0} anchorEl={anchorEl} {...popperOptions}>\r\n      <Paper className=\"hideScrollBar\" elevation={3} style={paperStyles}>\r\n        <AssetEditor editableAsset={Scene.assets.get(selectedAsset)} onClose={handleClose} />\r\n      </Paper>\r\n    </Popper>\r\n*/","import React from 'react';\r\n\r\nexport default function useKeyPress(keyCode) {\r\n\r\n  const [keyDown, setKeyDown] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    const onKeyDown = ({key}) => {\r\n      if(keyCode === key) {\r\n        setKeyDown(true)\r\n      }\r\n    }\r\n\r\n    const onKeyUp = ({key}) => {\r\n      if(keyCode === key) {\r\n        setKeyDown(false)\r\n      }\r\n    }\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n    document.addEventListener('keyup', onKeyUp);\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', onKeyDown);\r\n      document.removeEventListener('keyup', onKeyUp);\r\n    }\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return keyDown;\r\n}","import React from 'react';\r\n\r\nexport default function Background({ ref, src, width, height }) {\r\n  return <>\r\n    <div style={{ \r\n      position: 'absolute', \r\n      top: '0px', \r\n      left: '0px',\r\n      width: width + 'px',\r\n      height: height + 'px',\r\n    }}>\r\n      <img alt=\"gameboard\"\r\n        src={src}\r\n        style={{ \r\n          display:'block', \r\n          width: width > 0 ? width + 'px' : 'auto', \r\n          height: height > 0 ? height + 'px' : 'auto',\r\n        }}\r\n      />\r\n    </div>\r\n  </>\r\n}","import React from 'react';\r\n\r\nimport { HexGrid, Layout, GridGenerator, Hexagon } from 'react-hexgrid';\r\nimport { MenuProvider } from 'react-contexify';\r\n\r\nexport default function Grid({ container, settings, ContextMenu, onContextMenuOpen, hidden, onClick }) {\r\n  const { hexSize, width, height, xOffset, yOffset } = settings;\r\n  return <>\r\n    <MenuProvider id='menu_id_hex' onContextMenu={onContextMenuOpen}>\r\n      <div style={{ \r\n        position: 'absolute', \r\n        top: '0px', \r\n        left: '0px',\r\n        width: container.width + 'px',\r\n        height: container.height + 'px',\r\n      }}>\r\n        <HexGrid\r\n          width={container.width}\r\n          height={container.height}\r\n          viewBox={xOffset + \" \" + yOffset + \" 100 100\"}>\r\n          {\r\n            hidden ? null :\r\n            <Layout className=\"hexagons\"\r\n              size={{ x: hexSize, y: hexSize }}\r\n              spacing={1}\r\n              flat={false}\r\n              origin={{ x: 0, y: 0 }}\r\n            >\r\n              {\r\n                GridGenerator.rectangle(width, height).map((hex, i) => {\r\n                  hex.draggable = false;\r\n                  return <Hexagon\r\n                    key={i}\r\n                    q={hex.q}\r\n                    r={hex.r}\r\n                    s={hex.s}\r\n                    className={(hex.blocked ? 'blocked' : null)}\r\n                    data={hex}\r\n                    onClick={onClick}\r\n                  ></Hexagon>\r\n                })\r\n              }\r\n            </Layout>\r\n          }\r\n        </HexGrid>\r\n      </div>\r\n    </MenuProvider>\r\n    <ContextMenu />\r\n  </>\r\n}","import React from 'react'\r\n\r\nimport ScrollContainer from 'react-indiana-drag-scroll';\r\nimport { Menu, Item, Submenu } from 'react-contexify';\r\n\r\nimport Assets from './Assets';\r\nimport Background from './Background';\r\nimport Grid from './Grid';\r\n\r\nexport default function GameBoard({ name, assets, background, grid, player, sync, allowRightClick }) {\r\n\r\n  const handleAssetChange = (change) => {\r\n    sync(change)    \r\n  }\r\n\r\n  const ping = ({event, props}) => {\r\n    let x = event.offsetX;\r\n    let y = event.offsetY;\r\n    sync({\r\n      target: 'grid',\r\n      function: 'ping',\r\n      data: { x, y }\r\n    })\r\n  }\r\n\r\n  const onGridClick = (event, props) => {\r\n    let x = event.nativeEvent.offsetX;\r\n    let y = event.nativeEvent.offsetY;\r\n    console.log('Clicked grid at:', x, y)\r\n  }\r\n\r\n  const GridContextMenu = (e) => (\r\n    !allowRightClick ? null :\r\n    <Menu id='menu_id_hex'>\r\n      <Item onClick={ping}>Ping Location</Item>\r\n    </Menu>\r\n  );\r\n\r\n  const onAssetRightClick = (id, asset) => {\r\n    console.log('Right clicked', {id, asset})\r\n  }\r\n\r\n  const onEditAsset = (id, asset) => {\r\n    console.log({id, asset})\r\n  }\r\n  \r\n  const onRemoveAsset = (id, asset) => {\r\n    console.log({id, asset})\r\n  }\r\n\r\n  const getAssetContextMenu = (asset, id) => {\r\n    return (\r\n      !allowRightClick ? null :\r\n      <Menu id={'asset_menu' + id} style={{ zIndex: '10' }} onShown={() => onAssetRightClick(id, asset)}>\r\n        <Item onClick={() => onEditAsset(id, asset)}>Edit</Item>\r\n        <Submenu label=\"Delete\">\r\n          <Item onClick={() => onRemoveAsset(id, asset)}>Confirm</Item>\r\n        </Submenu>\r\n      </Menu>\r\n    )\r\n  }\r\n\r\n  const onGridContextMenuOpen = () => {\r\n    if(allowRightClick) console.log('Opened Grid Context Menu')\r\n  }\r\n\r\n  return <>\r\n    <ScrollContainer className=\"game-board\" ignoreElements={\".game-piece\"} hideScrollbars={false}>\r\n      <Background {...background} />\r\n      <Grid container={background} settings={grid} onClick={onGridClick} ContextMenu={GridContextMenu} onContextMenuOpen={onGridContextMenuOpen} hidden={false} />\r\n      <Assets assets={assets} ContextMenu={getAssetContextMenu} onChange={handleAssetChange} locked={false} />\r\n    </ScrollContainer>\r\n  </>\r\n}","const defaultScene = {\r\n  name: 'The Pool of Dreams',\r\n  background: {\r\n    src: 'https://mk0a2minutetabl7hq7i.kinstacdn.com/wp-content/uploads/2019/05/Jungle-Temple-RPG-battle-map-color.jpg', \r\n    width: 1600,\r\n    height: 1120,\r\n  },\r\n  grid: {\r\n    hexSize: 5.4,\r\n    width: 16,\r\n    height: 13,\r\n    xOffset: 21.4,\r\n    yOffset: -2,\r\n  },\r\n  assets: [\r\n    {\r\n      type: 'avatar',\r\n      src: \"https://theoneworldblog.files.wordpress.com/2017/11/shepherd-druid.jpg?w=100\",\r\n      x: 1315,\r\n      y: 519,\r\n      textColor: 'rgba(255,255,255,0.87)',\r\n      backgroundColor: 'rgba(255,51,51,1)',\r\n      text: 'Dalla',\r\n      width: 1,\r\n      height: 1\r\n    },\r\n    {\r\n      type: 'avatar',\r\n      src: \"https://external-preview.redd.it/rBBZcGNkiqI9Bvx-fB9XT9KEniDWNeuBNvs5EtZylYc.png?auto=webp&s=149ae6bfeeccd69989b1650309d623352fcaa4ca\",\r\n      x: 215,\r\n      y: 246,\r\n      textColor: 'rgba(255,255,255,0.87)',\r\n      backgroundColor: 'rgba(55,251,51,1)',\r\n      text: 'Thader',\r\n      width: 1,\r\n      height: 1\r\n    }, \r\n    {\r\n      type: 'object',\r\n      src: \"https://i.pinimg.com/originals/f2/8d/ed/f28ded56a3a38308a0d770d009f90416.png\",\r\n      x: 476,\r\n      y: 616,\r\n      width: 150,\r\n      height: 150,\r\n      rotation: 140,\r\n      locked: true,\r\n    }, \r\n    {\r\n      type: 'object',\r\n      src: \"https://i.pinimg.com/originals/f2/8d/ed/f28ded56a3a38308a0d770d009f90416.png\",\r\n      x: 536,\r\n      y: 436,\r\n      width: 150,\r\n      height: 150,\r\n      rotation: 0,\r\n      locked: true,\r\n    }, \r\n    {\r\n      type: 'text',\r\n      text: 'Hero',\r\n      fontSize: 80,\r\n      fontWeight: 'bold',\r\n      x: 795,\r\n      y: 320,\r\n      textColor: 'rgba(255,255,2550.87)',\r\n      backgroundColor: 'rgba(0,0,0,0)',\r\n      width: 360,\r\n      height: 240,\r\n      locked: true,\r\n    },\r\n    {\r\n      type: 'text',\r\n      text: 'Drop',\r\n      fontSize: 80,\r\n      fontWeight: 'bold',\r\n      x: 845,\r\n      y: 412,\r\n      textColor: 'rgba(255,255,2550.87)',\r\n      backgroundColor: 'rgba(0,0,0,0)',\r\n      width: 360,\r\n      height: 240,\r\n      locked: true,\r\n    }\r\n  ]\r\n}\r\n\r\nexport default defaultScene;","import React from 'react';\n//import { BrowserRouter as Router, Route, Switch, Redirect } from \"react-router-dom\";\n\nimport { MuiThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Button from \"@material-ui/core/Button\";\nimport Popper from '@material-ui/core/Popper';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\n\nimport useDocumentTitle from './hooks/useDocumentTitle';\nimport useMagic from './services/Magic';\nimport useSceneManager from './services/Scene';\nimport GameBoard from './components/gameboard/GameBoard';\n\nimport './App.css';\nimport 'react-contexify/dist/ReactContexify.min.css';\nimport defaultScene from './defaultScene';\n\nconst customMuiTheme = createMuiTheme({ palette: { type: \"dark\" }});\n\nasync function Server(storage, name) {\n  let thread = await storage.joinThread(name,{ ghost: true});\n  return {\n    storage,\n    thread,\n    sync: (unsyncedData) => {\n      thread.post(unsyncedData)\n    },\n    onUpdate: (fn) => thread.onUpdate(fn)\n  };\n}\n\nfunction LoginButton({ handleLogin }) {\n  \n  const [anchorEl, setAnchorEl] = React.useState(React.createRef());\n  const [open, setOpen] = React.useState(false);\n  const [email, setEmail] = React.useState('');\n\n  const submit = (e) => {\n    e.preventDefault();\n    handleLogin(email);\n    setOpen(false);\n  };\n\n  return <>\n    <Button ref={anchorEl}\n      style={{ backgroundColor: '#44975f', color: 'white', width: '97px' }} \n      size=\"large\" variant=\"contained\" \n      onClick={() => setOpen(!open)}\n    >\n      { !open ? 'login' : 'close' }\n    </Button>\n    <Popper open={open} anchorEl={anchorEl.current} placement=\"bottom-end\">\n      <Paper style={{ marginTop: '24px', padding: '24px', maxWidth: '272px' }} elevation={10}>\n        <form noValidate autoComplete=\"on\" onSubmit={submit}>\n          <TextField\n            inputProps={{ style: { textAlign: 'center' } }}\n            variant=\"outlined\"\n            fullWidth\n            name=\"email\"\n            type=\"email\"\n            placeholder=\"Enter your email\"\n            value={email}\n            onChange={(e) => {setEmail(e.target.value)}}\n          />\n          <Button style={{ width: '100%', margin: '12px 0px 0px 0px'}}\n            type=\"submit\"\n            disabled={!email}>\n            continue\n          </Button>\n        </form>\n      </Paper>\n    </Popper>\n  </>\n}\n\nfunction AccountButton({ handleLogin }) {\n  \n  const [anchorEl, setAnchorEl] = React.useState(React.createRef());\n  const [open, setOpen] = React.useState(false);\n  const [email, setEmail] = React.useState('');\n  \n\n  const submit = (e) => {\n    e.preventDefault();\n    handleLogin(email);\n    setOpen(false);\n  };\n\n  return <>\n    <Button ref={anchorEl} \n      style={{ backgroundColor: '#44975f', color: 'white', width: '97px' }} \n      size=\"large\" \n      variant=\"contained\" \n      onClick={() => setOpen(!open)}\n    >\n      Account\n    </Button>\n    <Popper open={open} anchorEl={anchorEl.current} placement=\"bottom-end\">\n      <Paper style={{ marginTop: '24px', padding: '24px', maxWidth: '272px' }} elevation={10}>\n        Account\n      </Paper>\n    </Popper>\n  </>\n}\n\nfunction App() {\n\n  useDocumentTitle(\"Hero Drop\");\n  const magic = useMagic();\n  const [scene, updateScene, setScene] = useSceneManager(defaultScene);\n  const [player, setPlayer] = React.useState();\n  const [loggedIn, setLoggedIn] = React.useState(false);\n  const [loggingIn, setLoggingIn] = React.useState(false);\n  const [server, setServer] = React.useState();\n\n  const handleLogin = async (email) => {\n    console.log('Logging in with', email)\n    if(!email) return;\n\n    setLoggingIn(true);\n\n    const playerObj = await magic.login(email);\n    const serverObj = await Server(playerObj.storage, 'hero-drop-app')\n    \n    function handleSync(data, b) {\n      if(data.author !== serverObj.thread._3id.DID){\n        let change = data.message;\n        if(change.target === 'asset') {\n          let { id, x, y } = change.data;\n          if(change.function === 'handleDrop') {\n            scene.assets.get(id)[1]({x,y})        \n          }\n        }\n      }\n      else {\n        // This change was already done locally\n      }\n    }\n\n    serverObj.onUpdate(handleSync)\n    console.log(playerObj)\n    console.log(serverObj)\n    setPlayer(playerObj);\n    setServer(serverObj);\n    console.log('connected to server')\n    //console.log(server)\n    // validate(email)\n    // handleLogin(email);\n\n    setLoggedIn(true);\n    setLoggingIn(false);\n  }\n\n  const sync = async (change) => {\n    if(server) {\n      server.sync(change)\n    }\n    \n    if(change.target === 'asset') {\n      let { id, x, y } = change.data;\n      if(change.function === 'handleDrop') {\n        scene.assets.get(id)[1]({x,y})        \n      }\n    }\n  }\n  \n  React.useEffect(() => {\n    /* Auto Login * /\n    handleLogin('chicobitcoinjoe@gmail.com')\n    /* */\n  }, [])\n  \n  return (\n    <MuiThemeProvider theme={customMuiTheme}>\n      <CssBaseline />\n      <div style={{ position: 'relative', width: '100%', height: '100%' }}>\n        <div style={{ zIndex: '2', position: 'absolute', top: '24px', right: '24px' }}>\n          { loggedIn || loggingIn ? null : <LoginButton handleLogin={handleLogin} /> }\n        </div>\n        <GameBoard {...scene} player={player} sync={sync} allowRightClick={true} />\n      </div>    \n    </MuiThemeProvider>\n  );\n  /*\n      <Router>\n        <Switch>\n          <Route exact path=\"/hero-drop-app/sandbox\" render={(props) => <Sandbox {...props} User={User} Scene={Scene} />} />\n          <Route exact path=\"/hero-drop-app/campaign/:campaignId\" render={(props) => <Campaign {...props} User={User} Scene={Scene} />} />\n          <Route render={() => <Redirect to=\"/hero-drop-app/sandbox\" />} />\n        </Switch>\n      </Router>\n  */\n}\n\nexport default App;\n","import React from 'react';\r\n\r\nexport default function useDocumentTitle(title) {\r\n  React.useEffect(() => {\r\n    document.title = title;\r\n  });\r\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}